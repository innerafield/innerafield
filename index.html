<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=yes">
<meta name="description" content="Find your purpose. Connect to Source. For all beings. For peace.">
<meta name="theme-color" content="#000000">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="Innera Field">
<link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%23000' width='100' height='100'/><circle cx='50' cy='50' r='30' fill='none' stroke='%23ff1493' stroke-width='2'/></svg>">
<title>Innera Field</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}

:root{
  --void:#000;
  --light:#fff;
  --dim:rgba(255,255,255,.6);
  --faint:rgba(255,255,255,.35);
  --glass:rgba(255,255,255,.05);
  --border:rgba(255,255,255,.12);
  --pink:rgba(255,20,147,.45);
  --blue:rgba(0,191,255,.45);
  --purple:rgba(138,43,226,.4);
  --gold:rgba(255,215,0,.5);
}

html,body{
  width:100%;
  height:100%;
  overflow:hidden;
}

body{
  font-family:Inter,-apple-system,sans-serif;
  background:var(--void);
  color:var(--light);
  display:flex;
  align-items:center;
  justify-content:center;
  -webkit-tap-highlight-color:transparent;
  animation:awakening 1.5s ease-out;
}

@keyframes awakening{
  0%{opacity:0}
  100%{opacity:1}
}

/* Cosmic background */
.cosmos{
  position:fixed;
  inset:0;
  z-index:0;
  background:
    radial-gradient(ellipse at 30% 20%,var(--pink),transparent 50%),
    radial-gradient(ellipse at 70% 80%,var(--blue),transparent 50%),
    radial-gradient(circle at 50% 50%,var(--purple),transparent 60%);
  opacity:.45;
  animation:cosmicPulse 12s ease-in-out infinite;
  pointer-events:none;
}

@keyframes cosmicPulse{
  0%,100%{opacity:.4}
  50%{opacity:.6}
}

/* Main container */
.field{
  position:relative;
  z-index:1;
  width:100%;
  height:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  padding:1.5rem;
  text-align:center;
}

/* Title */
.title{
  position:absolute;
  top:max(10vh,55px);
  font-size:clamp(1.5rem,5.5vw,3rem);
  font-weight:700;
  letter-spacing:.5em;
  padding-left:.5em;
  background:linear-gradient(135deg,#ff1493,#00bfff,#9b59b6,#ff1493);
  background-size:300% 300%;
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  animation:titleShimmer 8s ease-in-out infinite;
  user-select:none;
  white-space:nowrap;
}

@keyframes titleShimmer{
  0%,100%{background-position:0% 50%}
  50%{background-position:100% 50%}
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONTROLS - Share on LEFT, others on RIGHT
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.controls-left{
  position:absolute;
  top:max(2vh,12px);
  left:max(2.5vw,12px);
  display:flex;
  gap:.5rem;
  z-index:100;
}

.controls-right{
  position:absolute;
  top:max(2vh,12px);
  right:max(2.5vw,12px);
  display:flex;
  gap:.5rem;
  z-index:100;
}

.ctrl{
  background:transparent;
  border:none;
  color:var(--dim);
  width:46px;
  height:46px;
  cursor:pointer;
  transition:all .25s ease;
  opacity:.55;
  display:flex;
  align-items:center;
  justify-content:center;
  border-radius:50%;
  font-size:1.4rem;
}

.ctrl:hover,.ctrl:focus{
  opacity:1;
  color:var(--light);
  background:rgba(255,255,255,.05);
}

.ctrl.on{
  opacity:1;
  color:#ff1493;
}

.ctrl.hidden{
  display:none;
}

/* The Circle */
.circle{
  position:relative;
  width:min(260px,50vw);
  height:min(260px,50vw);
  border-radius:50%;
  background:radial-gradient(circle at 40% 35%,rgba(255,20,147,.06),transparent 60%);
  border:2px solid var(--border);
  box-shadow:0 0 80px var(--pink);
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  cursor:pointer;
  transform:scale(1) translateZ(0);
  will-change:transform,box-shadow;
  transition:transform .4s ease-out,box-shadow .4s ease-out,border-color .4s ease;
}

.circle.idle{
  animation:heartbeat 5s ease-in-out infinite;
}

@keyframes heartbeat{
  0%,100%{transform:scale(1);box-shadow:0 0 80px var(--pink)}
  50%{transform:scale(1.02);box-shadow:0 0 100px var(--pink)}
}

.circle.starting{
  transform:scale(1.08) translateZ(0);
  transition:transform .4s ease-out;
}

.circle.breathing{
  transition:transform 4s cubic-bezier(0.4,0,0.2,1),box-shadow 4s ease-in-out,border-color 1s ease;
}

.circle.breathing.inhale{
  transform:scale(1.35) translateZ(0);
  border-color:rgba(255,215,0,.45);
  box-shadow:0 0 120px var(--gold);
  transition:transform 4.5s cubic-bezier(0.25,0.1,0.25,1),box-shadow 4s ease-in-out,border-color 1s ease;
}

.circle.breathing.hold-in{
  transform:scale(1.35) translateZ(0);
  border-color:rgba(255,180,150,.4);
  box-shadow:0 0 100px rgba(255,180,150,.45);
}

.circle.breathing.exhale{
  transform:scale(0.72) translateZ(0);
  border-color:rgba(0,191,255,.4);
  box-shadow:0 0 60px var(--blue);
}

.circle.breathing.hold-out{
  transform:scale(0.72) translateZ(0);
  border-color:rgba(138,43,226,.4);
  box-shadow:0 0 55px var(--purple);
}

.circle:hover:not(.breathing){border-color:rgba(255,255,255,.2)}
.circle:focus{outline:none}
.circle:focus-visible{outline:2px solid rgba(255,255,255,.35);outline-offset:14px}

/* Circle text */
.word{
  font-size:clamp(1.05rem,3.2vw,1.4rem);
  font-weight:400;
  letter-spacing:.28em;
  padding-left:.28em;
  text-transform:uppercase;
  opacity:.9;
  transition:all .8s ease;
  user-select:none;
}

.hint{
  font-size:clamp(.8rem,2.2vw,1rem);
  font-weight:300;
  letter-spacing:.15em;
  margin-top:.7rem;
  opacity:.45;
  transition:opacity .8s ease;
  color:var(--dim);
}

.breathing .hint{opacity:0;display:none}

.phase{
  font-size:clamp(.75rem,2vw,.95rem);
  font-weight:300;
  letter-spacing:.16em;
  margin-top:.5rem;
  opacity:0;
  transition:opacity .8s ease;
  color:var(--dim);
}

.breathing .phase{opacity:1}

.timer{
  font-size:clamp(.65rem,1.6vw,.8rem);
  letter-spacing:.1em;
  margin-top:.4rem;
  opacity:0;
  color:var(--faint);
  transition:opacity .8s ease;
}

.breathing .timer{opacity:1}

/* Wisdom area */
.wisdom-area{
  position:absolute;
  bottom:max(11vh,70px);
  text-align:center;
  max-width:min(88%,420px);
}

.wisdom{
  font-size:clamp(.85rem,2.3vw,1.05rem);
  font-weight:300;
  letter-spacing:.05em;
  line-height:1.8;
  opacity:0;
  transition:opacity 2s ease;
  font-style:italic;
  color:rgba(255,255,255,.55);
}

.active .wisdom{opacity:1}

.session-msg{
  margin-top:1rem;
  font-size:clamp(.8rem,2vw,.95rem);
  letter-spacing:.12em;
  opacity:0;
  color:var(--dim);
  transition:opacity 1.5s ease;
  line-height:1.8;
}

.session-msg.show{opacity:1}

.session-msg .count{
  color:rgba(255,20,147,.8);
}

/* Energy exchange */
.energy{
  position:absolute;
  bottom:max(2.5vh,12px);
  font-size:clamp(.75rem,1.8vw,.9rem);
  letter-spacing:.1em;
  opacity:.3;
  transition:opacity .4s ease;
  color:var(--dim);
  display:flex;
  align-items:center;
  gap:.6rem;
}

.energy:hover{opacity:.6}

.energy span{opacity:.7}

.energy-btn{
  background:none;
  border:none;
  color:inherit;
  font-size:1.1rem;
  cursor:pointer;
  padding:.4rem;
  opacity:.75;
  transition:all .3s;
  min-width:40px;
  min-height:40px;
  display:flex;
  align-items:center;
  justify-content:center;
}

.energy-btn:hover{
  opacity:1;
  color:var(--light);
  transform:scale(1.1);
}

/* Toast */
.toast{
  position:fixed;
  bottom:18%;
  left:50%;
  transform:translateX(-50%) translateY(20px);
  background:rgba(0,0,0,.94);
  border:1px solid var(--border);
  padding:1rem 1.8rem;
  border-radius:12px;
  font-size:.9rem;
  letter-spacing:.08em;
  opacity:0;
  pointer-events:none;
  transition:all .4s ease;
  z-index:300;
  text-align:center;
  max-width:90%;
}

.toast.show{
  opacity:1;
  transform:translateX(-50%) translateY(0);
}

.toast .icon{
  font-size:1.3rem;
  margin-bottom:.5rem;
}

/* Donation modal */
.donate-modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.9);
  z-index:250;
  display:flex;
  align-items:center;
  justify-content:center;
  opacity:0;
  pointer-events:none;
  transition:opacity .4s ease;
}

.donate-modal.show{
  opacity:1;
  pointer-events:auto;
}

.donate-content{
  background:rgba(10,10,10,.98);
  border:1px solid var(--border);
  border-radius:16px;
  padding:2.2rem;
  text-align:center;
  max-width:min(90%,340px);
}

.donate-content h3{
  font-size:.95rem;
  font-weight:500;
  letter-spacing:.2em;
  margin-bottom:1.6rem;
  color:var(--dim);
}

.donate-qr{
  width:160px;
  height:160px;
  margin:0 auto 1.2rem;
  background:#fff;
  border-radius:12px;
  padding:10px;
}

.donate-qr img{
  width:100%;
  height:100%;
}

.donate-address{
  font-size:.7rem;
  letter-spacing:.03em;
  color:var(--faint);
  word-break:break-all;
  margin-bottom:1.2rem;
  padding:1rem;
  background:var(--glass);
  border-radius:10px;
  cursor:pointer;
  transition:all .3s;
}

.donate-address:hover{
  background:rgba(255,255,255,.1);
  color:var(--light);
}

.donate-close{
  background:none;
  border:1px solid var(--border);
  color:var(--dim);
  padding:.75rem 1.8rem;
  font-size:.85rem;
  letter-spacing:.12em;
  cursor:pointer;
  border-radius:10px;
  transition:all .3s;
}

.donate-close:hover{
  border-color:rgba(255,255,255,.3);
  color:var(--light);
}

/* iOS Install Modal */
.ios-modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.9);
  z-index:250;
  display:flex;
  align-items:center;
  justify-content:center;
  opacity:0;
  pointer-events:none;
  transition:opacity .4s ease;
}

.ios-modal.show{
  opacity:1;
  pointer-events:auto;
}

.ios-content{
  background:rgba(10,10,10,.98);
  border:1px solid var(--border);
  border-radius:16px;
  padding:2rem;
  text-align:center;
  max-width:min(90%,320px);
}

.ios-content h3{
  font-size:1rem;
  font-weight:500;
  letter-spacing:.15em;
  margin-bottom:1.2rem;
  color:var(--light);
}

.ios-steps{
  text-align:left;
  font-size:.9rem;
  line-height:2;
  color:var(--dim);
  margin-bottom:1.5rem;
}

.ios-steps span{
  font-size:1.1rem;
  margin-right:.5rem;
}

.ios-close{
  background:none;
  border:1px solid var(--border);
  color:var(--dim);
  padding:.75rem 1.8rem;
  font-size:.85rem;
  letter-spacing:.12em;
  cursor:pointer;
  border-radius:10px;
  transition:all .3s;
}

.ios-close:hover{
  border-color:rgba(255,255,255,.3);
  color:var(--light);
}

/* Menu panel */
.menu{
  position:fixed;
  top:0;
  right:-340px;
  width:min(300px,88vw);
  height:100%;
  background:rgba(5,5,5,.97);
  border-left:1px solid var(--border);
  z-index:200;
  transition:right .35s ease-out;
  overflow-y:auto;
  padding:1.5rem;
  display:flex;
  flex-direction:column;
}

.menu.open{right:0}

.menu-close{
  position:absolute;
  top:1rem;
  right:1rem;
  background:none;
  border:none;
  color:var(--dim);
  font-size:1.8rem;
  cursor:pointer;
  transition:color .3s;
  width:44px;
  height:44px;
  display:flex;
  align-items:center;
  justify-content:center;
}

.menu-close:hover{color:var(--light)}

.menu h3{
  font-size:.7rem;
  font-weight:500;
  letter-spacing:.2em;
  color:var(--faint);
  margin:1.5rem 0 .7rem;
  text-transform:uppercase;
}

.menu h3:first-of-type{margin-top:.8rem}

/* Journey items with ICONS */
.menu-item{
  display:flex;
  align-items:center;
  padding:.7rem .9rem;
  margin:.2rem 0;
  background:transparent;
  border:1px solid transparent;
  border-radius:10px;
  cursor:pointer;
  transition:all .25s ease;
  font-size:.95rem;
  color:var(--dim);
}

.menu-item:hover{
  background:var(--glass);
  color:var(--light);
}

.menu-item.selected{
  border-color:rgba(255,20,147,.3);
  background:rgba(255,20,147,.08);
  color:var(--light);
}

.menu-item .journey-icon{
  width:24px;
  height:24px;
  display:flex;
  align-items:center;
  justify-content:center;
  margin-right:.7rem;
  font-size:1rem;
  opacity:.7;
  flex-shrink:0;
}

.menu-item.selected .journey-icon{
  opacity:1;
  color:#ff1493;
}

.menu-divider{
  height:1px;
  background:var(--border);
  margin:1rem 0;
}

.time-row{
  display:flex;
  gap:.4rem;
}

.time-btn{
  flex:1;
  padding:.7rem .3rem;
  background:transparent;
  border:1px solid transparent;
  border-radius:10px;
  color:var(--dim);
  font-size:.85rem;
  cursor:pointer;
  transition:all .25s;
}

.time-btn:hover{background:var(--glass);color:var(--light)}
.time-btn.selected{border-color:rgba(255,20,147,.3);background:rgba(255,20,147,.08);color:var(--light)}

.toggle-row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:.7rem 0;
  font-size:.95rem;
  color:var(--dim);
}

.toggle{
  width:46px;
  height:24px;
  background:var(--glass);
  border:1px solid var(--border);
  border-radius:12px;
  cursor:pointer;
  position:relative;
  transition:all .3s;
}

.toggle::after{
  content:'';
  position:absolute;
  top:2px;
  left:3px;
  width:18px;
  height:18px;
  background:var(--dim);
  border-radius:50%;
  transition:all .3s;
}

.toggle.on{
  background:rgba(255,20,147,.2);
  border-color:rgba(255,20,147,.45);
}

.toggle.on::after{
  left:23px;
  background:#ff1493;
}

/* Menu icon row at bottom */
.menu-icons{
  margin-top:auto;
  padding-top:1rem;
  border-top:1px solid var(--border);
  display:flex;
  justify-content:center;
  gap:.3rem;
}

.menu-icon-btn{
  width:48px;
  height:48px;
  background:var(--glass);
  border:1px solid var(--border);
  border-radius:12px;
  color:var(--dim);
  font-size:1.2rem;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  transition:all .3s;
}

.menu-icon-btn:hover{
  background:rgba(255,255,255,.1);
  color:var(--light);
  border-color:rgba(255,255,255,.2);
}

.menu-icon-btn.on{
  background:rgba(255,20,147,.15);
  border-color:rgba(255,20,147,.4);
  color:#ff1493;
}

.menu-icon-btn.hidden{
  display:none;
}

/* Google Translate - hide branding */
.goog-te-gadget{
  font-family:inherit!important;
  font-size:0!important;
}
.goog-te-gadget span{display:none!important}
.goog-te-gadget select{
  background:var(--glass)!important;
  border:1px solid var(--border)!important;
  border-radius:8px!important;
  color:var(--dim)!important;
  padding:.5rem!important;
  font-size:.85rem!important;
  font-family:inherit!important;
  cursor:pointer!important;
}
.goog-te-banner-frame{display:none!important}
body{top:0!important}
.skiptranslate{display:none!important}

/* Overlay */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  z-index:150;
  opacity:0;
  pointer-events:none;
  transition:opacity .35s;
}

.overlay.show{opacity:1;pointer-events:auto}

/* Screen reader */
.sr{
  position:absolute;
  width:1px;height:1px;
  padding:0;margin:-1px;
  overflow:hidden;
  clip:rect(0,0,0,0);
  border:0;
}

/* High contrast */
body.contrast .circle{border:2px solid #fff;box-shadow:0 0 50px rgba(255,255,255,.3)}
body.contrast .word,body.contrast .phase,body.contrast .wisdom,body.contrast .title{
  -webkit-text-fill-color:#fff;color:#fff;opacity:1;
}

/* Reduced motion */
@media(prefers-reduced-motion:reduce){
  *{animation:none!important;transition-duration:.15s!important}
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESPONSIVE
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* Phone */
@media(max-width:600px){
  .title{
    top:max(8vh,48px);
    font-size:clamp(1.3rem,5vw,1.9rem);
    letter-spacing:.4em;
    padding-left:.4em;
  }
  .controls-left,.controls-right{
    top:10px;
  }
  .controls-left{left:10px}
  .controls-right{right:10px;gap:.4rem}
  .ctrl{
    width:44px;
    height:44px;
    font-size:1.3rem;
  }
  .circle{
    width:min(200px,52vw);
    height:min(200px,52vw);
  }
  .wisdom-area{bottom:max(9vh,58px)}
  .energy{gap:.5rem}
  .menu{padding:1.2rem}
  .menu-icons{gap:.2rem}
  .menu-icon-btn{width:44px;height:44px;font-size:1.1rem}
}

/* Very small phones */
@media(max-width:380px){
  .title{
    top:max(6vh,40px);
    font-size:1.2rem;
    letter-spacing:.32em;
    padding-left:.32em;
  }
  .controls-left{left:8px}
  .controls-right{right:8px;gap:.3rem}
  .ctrl{
    width:40px;
    height:40px;
    font-size:1.2rem;
  }
  .circle{
    width:min(180px,50vw);
    height:min(180px,50vw);
  }
  .menu{width:92vw;padding:1rem}
  .wisdom-area{bottom:max(8vh,50px)}
  .menu-icon-btn{width:40px;height:40px;font-size:1rem}
}

/* Large screens */
@media(min-width:1200px){
  .title{
    font-size:3.2rem;
  }
  .ctrl{
    width:52px;
    height:52px;
    font-size:1.6rem;
  }
  .circle{
    width:min(300px,32vw);
    height:min(300px,32vw);
  }
}
</style>
</head>
<body>

<div class="cosmos"></div>

<div class="field">
  <h1 class="title">INNERA FIELD</h1>

  <!-- Share & Install on LEFT -->
  <div class="controls-left">
    <button class="ctrl" id="shareBtn" aria-label="Share" title="Share">â†—</button>
    <button class="ctrl" id="installBtnTop" aria-label="Install" title="Install">â¬‡</button>
  </div>

  <!-- Sound, Contrast, Menu on RIGHT -->
  <div class="controls-right">
    <button class="ctrl" id="soundBtn" aria-label="Sound" aria-pressed="false" title="Sound">â™ª</button>
    <button class="ctrl" id="contrastBtn" aria-label="High contrast" aria-pressed="false" title="Contrast">â—</button>
    <button class="ctrl" id="menuBtn" aria-label="Open menu" title="Menu">â˜°</button>
  </div>

  <div class="circle idle" id="circle" role="button" tabindex="0" aria-label="Breathing circle. Tap to begin.">
    <span class="word" id="word">breathe</span>
    <span class="hint" id="hint">tap to begin</span>
    <span class="phase" id="phase"></span>
    <span class="timer" id="timerDisplay"></span>
  </div>

  <div class="wisdom-area">
    <p class="wisdom" id="wisdom"></p>
    <p class="session-msg" id="sessionMsg"></p>
  </div>

  <div class="energy">
    <span>if this serves you</span>
    <a class="energy-btn" href="https://ko-fi.com/innerafield" target="_blank" rel="noopener" title="Ko-fi">â™¡</a>
    <button class="energy-btn" id="btcBtn" title="Bitcoin">â‚¿</button>
    <button class="energy-btn" id="ethBtn" title="Ethereum">Î</button>
  </div>

  <div class="sr" id="sr" role="status" aria-live="assertive"></div>
</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<!-- Donation Modal -->
<div class="donate-modal" id="donateModal">
  <div class="donate-content">
    <h3 id="donateTitle">BITCOIN</h3>
    <div class="donate-qr">
      <img id="donateQR" src="" alt="QR Code">
    </div>
    <div class="donate-address" id="donateAddress" title="Click to copy"></div>
    <button class="donate-close" id="donateClose">close</button>
  </div>
</div>

<!-- iOS Install Modal -->
<div class="ios-modal" id="iosModal">
  <div class="ios-content">
    <h3>Add to Home Screen</h3>
    <div class="ios-steps">
      <div><span>1.</span> Tap the Share button <b>â™</b></div>
      <div><span>2.</span> Scroll and tap <b>Add to Home Screen</b></div>
      <div><span>3.</span> Tap <b>Add</b></div>
    </div>
    <button class="ios-close" id="iosClose">got it</button>
  </div>
</div>

<!-- Overlay -->
<div class="overlay" id="overlay"></div>

<!-- Menu -->
<nav class="menu" id="menu" aria-label="Settings">
  <button class="menu-close" id="menuClose" aria-label="Close menu">Ã—</button>

  <h3>Journey</h3>
  <div class="menu-item selected" data-journey="heart">
    <span class="journey-icon">â™¡</span>Heart Opening
  </div>
  <div class="menu-item" data-journey="awakening">
    <span class="journey-icon">âœ§</span>Awakening
  </div>
  <div class="menu-item" data-journey="grounding">
    <span class="journey-icon">â¬¡</span>Grounding
  </div>
  <div class="menu-item" data-journey="unity">
    <span class="journey-icon">âˆ</span>Unity
  </div>
  <div class="menu-item" data-journey="peace">
    <span class="journey-icon">â—¯</span>Deep Peace
  </div>

  <div class="menu-divider"></div>

  <h3>Duration</h3>
  <div class="time-row">
    <button class="time-btn" data-time="300">5 min</button>
    <button class="time-btn selected" data-time="600">10 min</button>
    <button class="time-btn" data-time="1200">20 min</button>
    <button class="time-btn" data-time="0">âˆ</button>
  </div>

  <div class="menu-divider"></div>

  <!-- Icon row at bottom: Voice, Language, Share, Install -->
  <div class="menu-icons">
    <button class="menu-icon-btn" id="voiceBtn" title="Voice Guidance" aria-label="Voice Guidance">ğŸ”ˆ</button>
    <button class="menu-icon-btn" id="langBtn" title="Language" aria-label="Language">ğŸŒ</button>
    <button class="menu-icon-btn" id="menuShareBtn" title="Share" aria-label="Share">â†—</button>
    <button class="menu-icon-btn" id="installBtn" title="Install App" aria-label="Install">â¬‡</button>
  </div>

  <!-- Hidden Google Translate (triggered by langBtn) -->
  <div id="google_translate_element" style="display:none"></div>
</nav>

<!-- Google Translate Script -->
<script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<script>
(function(){
'use strict';

// Google Translate init
window.googleTranslateElementInit = function() {
  new google.translate.TranslateElement({
    pageLanguage: 'en',
    includedLanguages: 'en,es,zh-CN,hi,ar,pt,ru,ja,ko,fr,de,it,vi,th,id',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
    autoDisplay: false
  }, 'google_translate_element');
};

const CRYPTO = {
  btc: 'bc1qwjsvjg0ckfw2aa9c5zdhc4ewxn7yse8lvstuaz',
  eth: '0x12e10C6aA1557A9B13c570c0070E223aec8dE498'
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   JOURNEYS with BINAURAL SHIFTS
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const JOURNEYS = {
  heart: {
    base: 6,
    shifts: [2, 1, -1, -2],
    freqs: [528, 432, 396, 417],
    volumes: [0.06, 0.05, 0.04, 0.025]
  },
  awakening: {
    base: 40,
    shifts: [3, 1, -1, -3],
    freqs: [741, 852, 963, 639],
    volumes: [0.06, 0.05, 0.04, 0.025]
  },
  grounding: {
    base: 2,
    shifts: [1, 0.5, -0.5, -1],
    freqs: [285, 432, 174, 128],
    volumes: [0.06, 0.05, 0.04, 0.025]
  },
  unity: {
    base: 10,
    shifts: [2, 1, -1, -2],
    freqs: [528, 639, 111, 432],
    volumes: [0.06, 0.05, 0.04, 0.025]
  },
  peace: {
    base: 4,
    shifts: [1.5, 0.5, -0.5, -1.5],
    freqs: [432, 396, 417, 528],
    volumes: [0.05, 0.04, 0.03, 0.02]
  }
};

const WISDOMS = [
  "you are worthy of love. you always have been.",
  "your heart knows the way. trust it.",
  "love is not earned. it is remembered.",
  "consciousness is not found. it is unveiled.",
  "the truth you seek is seeking you.",
  "you have always been the light you're looking for.",
  "stillness speaks louder than thought.",
  "you are held by the earth. always.",
  "your body is your first home. return to it.",
  "presence is the anchor. breath is the chain.",
  "you belong here. you have always belonged.",
  "separation is the illusion. oneness is the truth.",
  "there is no other. there is only one.",
  "peace begins when we remember we are one.",
  "every breath connects you to all beings.",
  "peace is not found. it is remembered.",
  "stillness is your nature. return to it.",
  "in the quiet, God speaks.",
  "surrender is not giving up. it is opening up.",
  "the deepest peace is already within you."
];

const S = {
  on: false,
  phase: 0,
  breaths: 0,
  sound: false,
  voice: false,
  journey: 'heart',
  duration: 600,
  elapsed: 0,
  timer: null,
  tickTimer: null,
  audio: null,
  osc: null,
  oscL: null,
  oscR: null,
  subOsc: null,
  gain: null,
  gainL: null,
  gainR: null,
  subGain: null,
  hasStarted: false,
  headphonesShown: false,
  deferredPrompt: null
};

try {
  const saved = localStorage.getItem('innerafield');
  if(saved){
    const p = JSON.parse(saved);
    S.journey = p.journey || 'heart';
    S.duration = p.duration ?? 600;
    S.sound = p.sound || false;
    S.voice = p.voice || false;
  }
} catch(e){}

const $ = id => document.getElementById(id);
const circle = $('circle');
const word = $('word');
const hint = $('hint');
const phase = $('phase');
const timerDisplay = $('timerDisplay');
const wisdom = $('wisdom');
const sessionMsg = $('sessionMsg');
const sr = $('sr');
const menu = $('menu');
const overlay = $('overlay');
const toast = $('toast');
const donateModal = $('donateModal');
const donateTitle = $('donateTitle');
const donateQR = $('donateQR');
const donateAddress = $('donateAddress');
const iosModal = $('iosModal');
const installBtn = $('installBtn');

const phases = ['inhale','hold-in','exhale','hold-out'];
const words = ['breathe in','hold','release','rest'];
const durations = [4000,4000,4000,4000];

function savePrefs(){
  try {
    localStorage.setItem('innerafield', JSON.stringify({
      journey: S.journey,
      duration: S.duration,
      sound: S.sound,
      voice: S.voice
    }));
  } catch(e){}
}

function initAudio(){
  if(S.audio) return;
  S.audio = new (window.AudioContext||window.webkitAudioContext)();
  
  S.gain = S.audio.createGain();
  S.gain.gain.value = 0;
  S.gain.connect(S.audio.destination);
  
  S.gainL = S.audio.createGain();
  S.gainR = S.audio.createGain();
  S.gainL.gain.value = 0;
  S.gainR.gain.value = 0;
  
  const merger = S.audio.createChannelMerger(2);
  S.gainL.connect(merger, 0, 0);
  S.gainR.connect(merger, 0, 1);
  merger.connect(S.audio.destination);
  
  S.subGain = S.audio.createGain();
  S.subGain.gain.value = 0;
  S.subGain.connect(S.audio.destination);
}

function fadeOutSolfeggio(){
  if(!S.audio || !S.gain) return;
  S.gain.gain.setTargetAtTime(0, S.audio.currentTime, 0.1);
}

function playFreq(hz, volume){
  if(!S.audio) return;
  
  if(S.osc){
    S.osc.frequency.setTargetAtTime(hz, S.audio.currentTime, 0.3);
  } else {
    S.osc = S.audio.createOscillator();
    S.osc.type = 'sine';
    S.osc.frequency.value = hz;
    S.osc.connect(S.gain);
    S.osc.start();
  }
  
  S.gain.gain.setTargetAtTime(volume, S.audio.currentTime, 0.3);
}

function playBinaural(beatHz){
  if(!S.audio) return;
  const baseHz = 200;
  
  if(!S.oscL){
    S.oscL = S.audio.createOscillator();
    S.oscL.type = 'sine';
    S.oscL.connect(S.gainL);
    S.oscL.start();
  }
  S.oscL.frequency.setTargetAtTime(baseHz, S.audio.currentTime, 0.2);
  
  if(!S.oscR){
    S.oscR = S.audio.createOscillator();
    S.oscR.type = 'sine';
    S.oscR.connect(S.gainR);
    S.oscR.start();
  }
  S.oscR.frequency.setTargetAtTime(baseHz + beatHz, S.audio.currentTime, 0.2);
  
  S.gainL.gain.setTargetAtTime(0.04, S.audio.currentTime, 0.3);
  S.gainR.gain.setTargetAtTime(0.04, S.audio.currentTime, 0.3);
}

function playSubBass(){
  if(!S.audio) return;
  if(!S.subOsc){
    S.subOsc = S.audio.createOscillator();
    S.subOsc.type = 'sine';
    S.subOsc.frequency.value = 50;
    S.subOsc.connect(S.subGain);
    S.subOsc.start();
  }
  S.subGain.gain.setTargetAtTime(0.12, S.audio.currentTime, 0.5);
}

function stopAudio(){
  if(S.audio){
    if(S.gain) S.gain.gain.setTargetAtTime(0, S.audio.currentTime, 0.4);
    if(S.gainL) S.gainL.gain.setTargetAtTime(0, S.audio.currentTime, 0.4);
    if(S.gainR) S.gainR.gain.setTargetAtTime(0, S.audio.currentTime, 0.4);
    if(S.subGain) S.subGain.gain.setTargetAtTime(0, S.audio.currentTime, 0.4);
  }
}

function speak(text){
  if(!S.voice || !window.speechSynthesis) return;
  speechSynthesis.cancel();
  const u = new SpeechSynthesisUtterance(text);
  u.rate = 0.75;
  u.pitch = 0.85;
  u.volume = 0.6;
  speechSynthesis.speak(u);
}

function showToast(msg, icon = ''){
  toast.innerHTML = icon ? '<div class="icon">' + icon + '</div>' + msg : msg;
  toast.classList.add('show');
  setTimeout(() => toast.classList.remove('show'), 3000);
}

function setPhase(i){
  S.phase = i;
  const p = phases[i];
  const journey = JOURNEYS[S.journey];
  
  circle.className = 'circle breathing ' + p;
  word.textContent = words[i];
  phase.textContent = p.replace('-in',' in').replace('-out',' out');
  sr.textContent = words[i];
  
  speak(words[i]);
  
  if(S.sound && S.audio){
    fadeOutSolfeggio();
    
    setTimeout(() => {
      if(!S.on) return;
      playFreq(journey.freqs[i], journey.volumes[i]);
      const binauralHz = journey.base + journey.shifts[i];
      playBinaural(binauralHz);
    }, 150);
  }
  
  if(i === 2) S.breaths++;
}

function next(){
  const n = (S.phase + 1) % 4;
  setPhase(n);
  S.timer = setTimeout(next, durations[n]);
}

function updateTimer(){
  if(!S.on) return;
  S.elapsed++;
  
  if(S.duration > 0){
    const remaining = S.duration - S.elapsed;
    if(remaining <= 0){
      stop();
      return;
    }
    const min = Math.floor(remaining / 60);
    const sec = remaining % 60;
    timerDisplay.textContent = min + ':' + (sec < 10 ? '0' : '') + sec;
  } else {
    timerDisplay.textContent = 'breath ' + S.breaths;
  }
  
  S.tickTimer = setTimeout(updateTimer, 1000);
}

function start(){
  if(S.on) return;
  S.on = true;
  S.breaths = 0;
  S.elapsed = 0;
  S.hasStarted = true;
  
  const journey = JOURNEYS[S.journey];
  
  document.body.classList.add('active');
  sessionMsg.classList.remove('show');
  sessionMsg.innerHTML = '';
  hint.style.display = 'none';
  
  wisdom.textContent = WISDOMS[Math.floor(Math.random() * WISDOMS.length)];
  
  circle.classList.remove('idle');
  circle.classList.add('starting');
  
  if(S.sound){
    initAudio();
    if(S.audio.state === 'suspended') S.audio.resume();
    playSubBass();
  }
  
  setTimeout(() => {
    circle.classList.remove('starting');
    setPhase(0);
    S.timer = setTimeout(next, durations[0]);
    updateTimer();
  }, 400);
  
  sr.textContent = 'Breathing started.';
}

function stop(){
  if(!S.on) return;
  S.on = false;
  
  document.body.classList.remove('active');
  
  clearTimeout(S.timer);
  clearTimeout(S.tickTimer);
  S.timer = null;
  S.tickTimer = null;
  
  circle.className = 'circle idle';
  word.textContent = 'breathe';
  phase.textContent = '';
  timerDisplay.textContent = '';
  
  stopAudio();
  
  sessionMsg.innerHTML = '<span class="count">âœ§ ' + S.breaths + ' breaths with Source âœ§</span><br>return when you forget.';
  sessionMsg.classList.add('show');
  
  setTimeout(() => {
    sessionMsg.classList.remove('show');
    wisdom.textContent = '';
  }, 6000);
  
  sr.textContent = S.breaths + ' breaths complete.';
}

function toggle(){
  S.on ? stop() : start();
}

function openMenu(){
  menu.classList.add('open');
  overlay.classList.add('show');
}

function closeMenu(){
  menu.classList.remove('open');
  overlay.classList.remove('show');
}

function initMenuState(){
  document.querySelectorAll('[data-journey]').forEach(el => {
    el.classList.toggle('selected', el.dataset.journey === S.journey);
  });
  document.querySelectorAll('[data-time]').forEach(el => {
    el.classList.toggle('selected', parseInt(el.dataset.time) === S.duration);
  });
  $('soundBtn').classList.toggle('on', S.sound);
  $('soundBtn').setAttribute('aria-pressed', S.sound);
  $('voiceBtn').classList.toggle('on', S.voice);
  $('voiceBtn').setAttribute('aria-pressed', S.voice);
}

document.querySelectorAll('[data-journey]').forEach(el => {
  el.addEventListener('click', () => {
    document.querySelectorAll('[data-journey]').forEach(e => e.classList.remove('selected'));
    el.classList.add('selected');
    S.journey = el.dataset.journey;
    savePrefs();
  });
});

document.querySelectorAll('[data-time]').forEach(el => {
  el.addEventListener('click', () => {
    document.querySelectorAll('[data-time]').forEach(e => e.classList.remove('selected'));
    el.classList.add('selected');
    S.duration = parseInt(el.dataset.time);
    savePrefs();
  });
});

// Voice button
$('voiceBtn').addEventListener('click', () => {
  S.voice = !S.voice;
  $('voiceBtn').classList.toggle('on', S.voice);
  $('voiceBtn').setAttribute('aria-pressed', S.voice);
  savePrefs();
  showToast(S.voice ? 'voice on' : 'voice off');
});

// Language button - trigger Google Translate
$('langBtn').addEventListener('click', () => {
  const select = document.querySelector('.goog-te-combo');
  if(select){
    select.focus();
    select.click();
  } else {
    showToast('loading languages...');
  }
});

$('menuBtn').addEventListener('click', openMenu);
$('menuClose').addEventListener('click', closeMenu);
overlay.addEventListener('click', () => {
  closeMenu();
  closeDonateModal();
  closeIosModal();
});

$('soundBtn').addEventListener('click', () => {
  S.sound = !S.sound;
  $('soundBtn').classList.toggle('on', S.sound);
  $('soundBtn').setAttribute('aria-pressed', S.sound);
  savePrefs();
  
  if(S.sound){
    if(!S.headphonesShown){
      showToast('headphones enhance<br>the binaural experience', 'ğŸ§');
      S.headphonesShown = true;
    }
    
    if(S.on){
      initAudio();
      if(S.audio.state === 'suspended') S.audio.resume();
      const journey = JOURNEYS[S.journey];
      playFreq(journey.freqs[S.phase], journey.volumes[S.phase]);
      const binauralHz = journey.base + journey.shifts[S.phase];
      playBinaural(binauralHz);
      playSubBass();
    }
  } else {
    stopAudio();
  }
});

$('contrastBtn').addEventListener('click', () => {
  document.body.classList.toggle('contrast');
  const on = document.body.classList.contains('contrast');
  $('contrastBtn').classList.toggle('on', on);
  $('contrastBtn').setAttribute('aria-pressed', on);
});

// Share functionality
async function shareApp(){
  const shareData = {
    title: 'Innera Field',
    text: 'Find your peace. Connect to Source. Free meditation for all beings.',
    url: 'https://innerafield.com'
  };
  
  if(navigator.share){
    try {
      await navigator.share(shareData);
    } catch(e){
      if(e.name !== 'AbortError'){
        copyShareLink();
      }
    }
  } else {
    copyShareLink();
  }
}

function copyShareLink(){
  navigator.clipboard.writeText('https://innerafield.com').then(() => {
    showToast('link copied âœ“<br>share the peace');
  }).catch(() => {
    showToast('innerafield.com');
  });
}

$('shareBtn').addEventListener('click', shareApp);
$('menuShareBtn').addEventListener('click', shareApp);

function copyToClipboard(text){
  navigator.clipboard.writeText(text).then(() => {
    showToast('address copied âœ“');
  }).catch(() => {
    showToast('copy failed');
  });
}

function showDonateModal(type){
  const addr = type === 'btc' ? CRYPTO.btc : CRYPTO.eth;
  const name = type === 'btc' ? 'BITCOIN' : 'ETHEREUM';
  
  donateTitle.textContent = name;
  donateAddress.textContent = addr;
  donateQR.src = 'https://api.qrserver.com/v1/create-qr-code/?size=160x160&data=' + encodeURIComponent(addr);
  
  donateModal.classList.add('show');
}

function closeDonateModal(){
  donateModal.classList.remove('show');
}

function closeIosModal(){
  iosModal.classList.remove('show');
}

$('btcBtn').addEventListener('click', () => showDonateModal('btc'));
$('ethBtn').addEventListener('click', () => showDonateModal('eth'));
$('donateClose').addEventListener('click', closeDonateModal);
donateAddress.addEventListener('click', () => copyToClipboard(donateAddress.textContent));
$('iosClose').addEventListener('click', closeIosModal);

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PWA INSTALL
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

const installBtnTop = $('installBtnTop');

// Detect iOS
function isIOS(){
  return /iPad|iPhone|iPod/.test(navigator.userAgent) || 
         (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
}

// Detect if already installed
function isStandalone(){
  return window.matchMedia('(display-mode: standalone)').matches ||
         window.navigator.standalone === true;
}

// Shared install handler
async function handleInstall(){
  if(S.deferredPrompt){
    // Android/Desktop - show native prompt
    S.deferredPrompt.prompt();
    const result = await S.deferredPrompt.userChoice;
    S.deferredPrompt = null;
    if(result.outcome === 'accepted'){
      showToast('installing...', 'âœ“');
      installBtn.classList.add('hidden');
      installBtnTop.classList.add('hidden');
    }
  } else if(isIOS()){
    // iOS - show instructions
    iosModal.classList.add('show');
  } else {
    // Fallback
    showToast('add to home screen<br>from browser menu');
  }
}

// Listen for install prompt (Android/Desktop)
window.addEventListener('beforeinstallprompt', e => {
  e.preventDefault();
  S.deferredPrompt = e;
  installBtn.classList.remove('hidden');
  installBtnTop.classList.remove('hidden');
});

// Handle install button clicks
installBtn.addEventListener('click', handleInstall);
installBtnTop.addEventListener('click', handleInstall);

// Hide install buttons if already installed
if(isStandalone()){
  installBtn.classList.add('hidden');
  installBtnTop.classList.add('hidden');
}

// Show install buttons for iOS (they can't auto-detect)
if(isIOS() && !isStandalone()){
  installBtn.classList.remove('hidden');
  installBtnTop.classList.remove('hidden');
}

circle.addEventListener('click', toggle);
circle.addEventListener('keydown', e => {
  if(e.key === 'Enter' || e.key === ' '){
    e.preventDefault();
    toggle();
  }
});

document.addEventListener('keydown', e => {
  if(e.key === ' ' && document.activeElement === document.body){
    e.preventDefault();
    toggle();
  }
  if(e.key === 'Escape'){
    if(donateModal.classList.contains('show')){
      closeDonateModal();
    } else if(iosModal.classList.contains('show')){
      closeIosModal();
    } else if(menu.classList.contains('open')){
      closeMenu();
    } else if(S.on){
      stop();
    }
  }
});

setTimeout(() => {
  if(!S.hasStarted && hint) hint.style.opacity = '0';
}, 8000);

initMenuState();

if(window.matchMedia('(prefers-contrast:more)').matches){
  document.body.classList.add('contrast');
  $('contrastBtn').classList.add('on');
  $('contrastBtn').setAttribute('aria-pressed', 'true');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PWA SERVICE WORKER REGISTRATION
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

// Register service worker for offline support
if('serviceWorker' in navigator){
  // Create a minimal service worker inline
  const swCode = `
    const CACHE = 'innera-v2';
    self.addEventListener('install', e => {
      e.waitUntil(
        caches.open(CACHE).then(c => c.addAll(['/']))
      );
      self.skipWaiting();
    });
    self.addEventListener('fetch', e => {
      e.respondWith(
        caches.match(e.request).then(r => r || fetch(e.request))
      );
    });
  `;
  
  const swBlob = new Blob([swCode], {type: 'application/javascript'});
  const swUrl = URL.createObjectURL(swBlob);
  
  navigator.serviceWorker.register(swUrl).catch(() => {
    // Service worker registration failed, but app still works
  });
}

// Create manifest dynamically for PWA
const manifest = {
  name: 'Innera Field',
  short_name: 'Innera',
  description: 'Connect to Source. Find your peace.',
  start_url: '/',
  display: 'standalone',
  background_color: '#000000',
  theme_color: '#ff1493',
  icons: [
    {
      src: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><rect fill="%23000" width="512" height="512" rx="90"/><circle cx="256" cy="256" r="120" fill="none" stroke="%23ff1493" stroke-width="8"/><circle cx="256" cy="256" r="80" fill="none" stroke="%23ff149366" stroke-width="4"/></svg>',
      sizes: '512x512',
      type: 'image/svg+xml',
      purpose: 'any maskable'
    }
  ]
};

const manifestBlob = new Blob([JSON.stringify(manifest)], {type: 'application/json'});
const manifestUrl = URL.createObjectURL(manifestBlob);
const manifestLink = document.createElement('link');
manifestLink.rel = 'manifest';
manifestLink.href = manifestUrl;
document.head.appendChild(manifestLink);

})();
</script>

</body>
</html>
